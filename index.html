<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="Themes & Motifs - The Philippines' most prestigious wedding resource. Find vendors, read reviews, and book suppliers."
    />
    <title>Themes & Motifs | The Wedding Marketplace</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&family=Lato:wght@300;400;700&display=swap"
      rel="stylesheet"
    />
    <style>
      /* Add this to your existing CSS */
      .cat-icon {
        width: 40px;
        height: 40px;
        stroke: var(--brand-brown); /* Uses your existing brown variable */
        stroke-width: 1.5;
        fill: none;
        stroke-linecap: round;
        stroke-linejoin: round;
        margin-bottom: 15px;
        transition: 0.3s;
      }

      /* Hover effect: slight bounce or color shift */
      .cat-card:hover .cat-icon {
        transform: scale(1.1);
        stroke: var(--brand-terra);
      }
      /* --- CORE VARIABLES & RESET --- */
      :root {
        --bg-cream: #fcfbf9;
        --text-dark: #2c2c2c;
        --brand-brown: #a67c52;
        --brand-green: #7a8b6e;
        --brand-terra: #c17a4e;
        --white: #ffffff;
        --light-gray: #eaeaea;
        --booking-blue: #003580; /* Retained for trust signals */
        --shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
      }

      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }
      body {
        background-color: var(--bg-cream);
        font-family: "Lato", sans-serif;
        color: var(--text-dark);
        line-height: 1.6;
      }
      h1,
      h2,
      h3,
      h4,
      .serif {
        font-family: "Playfair Display", serif;
      }

      .hidden {
        display: none !important;
      }
      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 20px;
      }
      button {
        cursor: pointer;
        transition: 0.3s;
      }

      /* --- HEADER --- */
      header {
        background: var(--white);
        border-bottom: 1px solid var(--light-gray);
        padding: 15px 0;
        position: sticky;
        top: 0;
        z-index: 1000;
      }
      .nav-flex {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .logo {
        font-family: "Playfair Display", serif;
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--text-dark);
        letter-spacing: 1px;
        cursor: pointer;
      }
      .nav-links {
        display: flex;
        gap: 20px;
        align-items: center;
      }
      .nav-item {
        font-size: 0.9rem;
        font-weight: 600;
        color: #555;
        text-decoration: none;
        cursor: pointer;
      }
      .btn-auth {
        padding: 8px 20px;
        border: 1px solid var(--brand-brown);
        color: var(--brand-brown);
        background: transparent;
        border-radius: 4px;
      }
      .btn-auth:hover {
        background: var(--brand-brown);
        color: white;
      }

      /* --- VIEWS --- */

      /* 1. HOME VIEW */
      .hero {
        display: flex;
        align-items: center;
        gap: 40px;
        padding: 60px 0;
      }
      .hero-text h1 {
        font-size: 3rem;
        line-height: 1.1;
        margin-bottom: 20px;
      }
      .hero-img {
        flex: 1;
        height: 400px;
        background: url("https://images.unsplash.com/photo-1519741497674-611481863552?w=800&q=80")
          center/cover;
        border-radius: 200px 200px 0 0;
      }

      .search-container {
        background: white;
        padding: 20px;
        box-shadow: var(--shadow);
        border-radius: 8px;
        margin-top: -30px;
        position: relative;
        z-index: 10;
        border: 1px solid #eee;
      }
      .search-grid {
        display: grid;
        grid-template-columns: 2fr 1fr 1fr auto;
        gap: 10px;
      }
      .form-input,
      .form-select {
        width: 100%;
        padding: 12px;
        border: 1px solid #ddd;
        border-radius: 4px;
        font-family: inherit;
      }
      .btn-primary {
        background: var(--brand-brown);
        color: white;
        border: none;
        padding: 12px 30px;
        border-radius: 4px;
        font-weight: bold;
      }

      .category-grid {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin: 40px 0;
        flex-wrap: wrap;
      }
      .cat-card {
        width: 120px;
        height: 120px;
        background: white;
        border: 1px solid #eee;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: 0.2s;
        position: relative;
      }
      .cat-card:hover {
        transform: translateY(-5px);
        box-shadow: var(--shadow);
        border-color: var(--brand-brown);
      }

      .cat-card.selected {
        border-color: var(--brand-terra);
        box-shadow: 0 8px 26px rgba(193, 122, 78, 0.15);
        transform: translateY(-6px) scale(1.02);
      }

      /* Selection highlight only (badge/check removed) */

      .vendor-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 25px;
        margin-bottom: 60px;
      }
      .v-card {
        background: white;
        border: 1px solid #eee;
        border-radius: 8px;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        transition: 0.3s;
      }
      .v-card:hover {
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      }
      .v-img {
        height: 180px;
        background: #ddd;
        background-size: cover;
        background-position: center;
      }
      .v-body {
        padding: 20px;
        flex: 1;
        display: flex;
        flex-direction: column;
      }
      .v-score {
        position: absolute;
        top: 10px;
        right: 10px;
        background: var(--brand-green);
        color: white;
        padding: 5px 10px;
        border-radius: 4px;
        font-weight: bold;
      }

      /* 2. VENDOR DETAIL VIEW */
      .detail-header {
        margin: 20px 0;
      }
      .detail-gallery {
        display: grid;
        grid-template-columns: 2fr 1fr;
        gap: 10px;
        height: 400px;
        margin-bottom: 30px;
      }
      .gal-main {
        background: #ccc;
        background-size: cover;
        border-radius: 8px 0 0 8px;
      }
      .gal-sub {
        display: flex;
        flex-direction: column;
        gap: 10px;
      }
      .gal-item {
        flex: 1;
        background: #ddd;
        background-size: cover;
        border-radius: 0 8px 8px 0;
      }

      .detail-layout {
        display: grid;
        grid-template-columns: 2fr 1fr;
        gap: 40px;
      }
      .booking-card {
        background: white;
        padding: 25px;
        border: 1px solid #ddd;
        border-radius: 8px;
        position: sticky;
        top: 100px;
        box-shadow: var(--shadow);
      }

      /* Reviews Section */
      .review-box {
        background: white;
        padding: 25px;
        border-radius: 8px;
        border: 1px solid #eee;
        margin-top: 30px;
      }
      .r-item {
        border-bottom: 1px solid #eee;
        padding: 20px 0;
      }
      .r-header {
        display: flex;
        justify-content: space-between;
        margin-bottom: 10px;
      }
      .r-score-badge {
        background: var(--brand-green);
        color: white;
        width: 30px;
        height: 30px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 4px;
        font-weight: bold;
      }
      .pros {
        color: green;
        font-size: 0.9rem;
      }
      .cons {
        color: #c0392b;
        font-size: 0.9rem;
      }

      /* 3. AUTH & ADMIN VIEW */
      .auth-container {
        max-width: 400px;
        margin: 60px auto;
        background: white;
        padding: 40px;
        border-radius: 8px;
        box-shadow: var(--shadow);
        text-align: center;
      }

      .admin-table {
        width: 100%;
        border-collapse: collapse;
        background: white;
        margin-top: 20px;
      }
      .admin-table th,
      .admin-table td {
        padding: 15px;
        border: 1px solid #eee;
        text-align: left;
      }
      .admin-table th {
        background: #f9f9f9;
      }
      .action-btn {
        padding: 5px 10px;
        font-size: 0.8rem;
        margin-right: 5px;
        border-radius: 4px;
        border: none;
      }
      .btn-del {
        background: #ffebee;
        color: #c62828;
      }
      .btn-edit {
        background: #e3f2fd;
        color: #1565c0;
      }

      /* Mobile */
      @media (max-width: 768px) {
        .hero,
        .detail-layout,
        .search-grid,
        .detail-gallery {
          grid-template-columns: 1fr;
          display: flex;
          flex-direction: column;
        }
        .hero-img {
          width: 100%;
          height: 250px;
        }
        .nav-links {
          display: none;
        } /* Simplified for demo */
      }
    </style>
  </head>
  <body>
    <header>
      <div class="container nav-flex">
        <div class="logo" onclick="app.navigate('home')">THEMES & MOTIFS</div>
        <nav class="nav-links">
          <a class="nav-item" onclick="app.navigate('home')">Vendors</a>
          <a class="nav-item">Bridal Fairs</a>
          <a
            class="nav-item"
            id="nav-admin"
            style="display: none"
            onclick="app.navigate('admin')"
            >Admin Dashboard</a
          >
          <div id="auth-section">
            <button class="btn-auth" onclick="app.navigate('login')">
              Sign In / Register
            </button>
          </div>
        </nav>
      </div>
    </header>

    <div id="view-home" class="container">
      <section class="hero">
        <div class="hero-text">
          <h1 class="serif">
            Plan your perfect day.<br /><span
              style="color: var(--brand-brown); font-style: italic"
              >Find the best suppliers.</span
            >
          </h1>
          <p>Search over 1,000 verified wedding vendors with real reviews.</p>
        </div>
        <div class="hero-img"></div>
      </section>

      <div class="search-container">
        <div class="search-grid">
          <input
            type="text"
            class="form-input"
            id="search-text"
            placeholder="Search Vendor Name (e.g. Nice Print)"
          />
          <select class="form-select" id="search-type">
            <option value="">All Categories</option>
            <option value="Venue">Venue</option>
            <option value="Photography">Photography</option>
            <option value="Catering">Catering</option>
            <option value="Stylist">Stylist</option>
            <option value="Attire">Attire</option>
          </select>
          <select class="form-select" id="search-sort">
            <option value="rating">Top Rated</option>
            <option value="price_low">Price: Low to High</option>
            <option value="price_high">Price: High to Low</option>
          </select>
          <button class="btn-primary" onclick="app.handleSearch()">
            Search
          </button>
        </div>
      </div>

      <div class="category-grid">
        <div
          class="cat-card"
          data-cat="Venue"
          onclick="app.filterByCat('Venue')"
        >
          <svg
            class="cat-icon"
            viewBox="0 0 24 24"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
            <circle cx="12" cy="10" r="3"></circle>
            <path
              d="M19 5.5a2.5 2.5 0 0 1 3.5 3.5M17 3.5a2 2 0 0 1 2.8 2.8"
              style="stroke-width: 1"
            ></path>
          </svg>

          <small>Venues</small>
        </div>

        <div
          class="cat-card"
          data-cat="Photography"
          onclick="app.filterByCat('Photography')"
        >
          <svg
            class="cat-icon"
            viewBox="0 0 24 24"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"
            ></path>
            <circle cx="12" cy="13" r="4"></circle>
            <path d="M4 6a1.5 1.5 0 0 1 2 2" style="stroke-width: 1"></path>
          </svg>

          <small>Photo</small>
        </div>

        <div
          class="cat-card"
          data-cat="Catering"
          onclick="app.filterByCat('Catering')"
        >
          <svg
            class="cat-icon"
            viewBox="0 0 24 24"
            xmlns="http://www.w3.org/2000/svg"
          >
            <circle cx="12" cy="12" r="10"></circle>
            <path
              d="M8 8v8M16 8v8M8 8a2 2 0 0 1-2-2M16 8a2 2 0 0 0 2-2M16 13h-8"
            ></path>
          </svg>

          <small>Catering</small>
        </div>

        <div
          class="cat-card"
          data-cat="Stylist"
          onclick="app.filterByCat('Stylist')"
        >
          <svg
            class="cat-icon"
            viewBox="0 0 24 24"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M12 22s-4-3-4-9c0-2.5 1.5-4 4-4s4 1.5 4 4c0 6-4 9-4 9z"
            ></path>
            <path
              d="M12 13l-3-5m6 5l3-5M9 7a2 2 0 1 1-2-2m10 2a2 2 0 1 0 2-2M12 5a2 2 0 1 1 0-4"
            ></path>
            <path d="M10 16h4"></path>
          </svg>

          <small>Styling</small>
        </div>

        <div
          class="cat-card"
          data-cat="Attire"
          onclick="app.filterByCat('Attire')"
        >
          <svg
            class="cat-icon"
            viewBox="0 0 24 24"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path d="M9 2h6l2 3s-1.5 2-5 2-5-2-5-2l2-3z"></path>
            <path d="M7 7s-3 8-3 15h16c0-7-3-15-3-15"></path>
            <path d="M12 7v15"></path>
          </svg>

          <small>Attire</small>
        </div>
      </div>

      <h2 class="serif" style="margin-bottom: 20px">Featured Vendors</h2>
      <div class="vendor-grid" id="vendor-list-container"></div>
    </div>

    <div id="view-detail" class="container hidden" style="padding-top: 40px">
      <button
        onclick="app.navigate('home')"
        style="
          background: none;
          border: none;
          text-decoration: underline;
          color: #666;
          margin-bottom: 10px;
        "
      >
        &larr; Back to Search
      </button>

      <div id="detail-content"></div>
    </div>

    <div id="view-login" class="container hidden">
      <div class="auth-container">
        <h2 class="serif">Welcome Back</h2>
        <p style="margin-bottom: 20px; color: #666">
          Sign in to save vendors and leave reviews.
        </p>
        <input
          type="email"
          id="login-email"
          class="form-input"
          placeholder="Email Address"
          style="margin-bottom: 10px"
        />
        <input
          type="password"
          id="login-pass"
          class="form-input"
          placeholder="Password"
          style="margin-bottom: 20px"
        />
        <button class="btn-primary" style="width: 100%" onclick="app.login()">
          Sign In
        </button>
        <p style="margin-top: 15px; font-size: 0.8rem">
          Try <strong>admin@themes.com</strong> for Admin Access.
        </p>
      </div>
    </div>

    <div id="view-admin" class="container hidden" style="padding-top: 40px">
      <h1 class="serif">Admin Dashboard</h1>
      <div style="display: flex; gap: 20px; margin-top: 20px">
        <div
          style="
            background: white;
            padding: 20px;
            flex: 1;
            border-radius: 8px;
            border: 1px solid #ddd;
          "
        >
          <h3>Total Vendors</h3>
          <p style="font-size: 2rem; font-weight: bold" id="admin-v-count">0</p>
        </div>
        <div
          style="
            background: white;
            padding: 20px;
            flex: 1;
            border-radius: 8px;
            border: 1px solid #ddd;
          "
        >
          <h3>Total Reviews</h3>
          <p style="font-size: 2rem; font-weight: bold" id="admin-r-count">0</p>
        </div>
      </div>

      <h3 style="margin-top: 40px">Manage Vendors</h3>
      <button
        class="btn-primary"
        style="padding: 5px 15px; font-size: 0.8rem; margin-bottom: 10px"
        onclick="alert('Feature: Add Vendor Modal would open here.')"
      >
        + Add New
      </button>
      <table class="admin-table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Category</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="admin-v-list"></tbody>
      </table>
    </div>

    <script>
      const mockVendors = [
        {
          id: 1,
          name: "Nice Print Photography",
          type: "Photography",
          location: "Quezon City",
          price: 85000,
          rating: 4.8,
          desc: "The Philippines' most sought-after celebrity wedding photographer. Capturing moments that last a lifetime with a cinematic touch.",
          images: [
            "https://images.unsplash.com/photo-1537633552985-df8429e8048b?w=600",
            "https://images.unsplash.com/photo-1511285560982-1351cdeb9821?w=600",
          ],
          contact: "inquiry@niceprint.com",
          map: "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3860.205792224056!2d121.03!3d14.64!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x0%3A0x0!2zMTTCsDM4JzM0LjEiTiAxMjHCsDAyJzEwLjUiRQ!5e0!3m2!1sen!2sph!4v1620000000000!5m2!1sen!2sph",
        },
        {
          id: 2,
          name: "Juan Carlo The Caterer",
          type: "Catering",
          location: "Batangas / Manila",
          price: 150000,
          rating: 4.9,
          desc: "Experience the taste of luxury. Known for their impeccable service and the famous roast beef station.",
          images: [
            "https://images.unsplash.com/photo-1555244162-803834f70033?w=600",
            "https://images.unsplash.com/photo-1504674900247-0877df9cc836?w=600",
          ],
          contact: "info@juancarlo.ph",
          map: "https://www.google.com/maps/embed?pb=...",
        },
        {
          id: 3,
          name: "Narra Hill",
          type: "Venue",
          location: "Tagaytay",
          price: 250000,
          rating: 4.7,
          desc: "A stunning pavilion set amidst lush gardens overlooking the Taal Lake. Perfect for intimate and rustic weddings.",
          images: [
            "https://dynamic-media-cdn.tripadvisor.com/media/photo-o/1b/17/b4/31/img-20190929-170312-01.jpg?w=900&h=500&s=1",
            "https://dynamic-media-cdn.tripadvisor.com/media/photo-o/1b/17/b4/31/img-20190929-170312-01.jpg?w=900&h=500&s=1",
          ],
          contact: "events@narrahill.com",
          map: "https://www.google.com/maps/embed?pb=...",
        },
        {
          id: 4,
          name: "Gideon Hermosa",
          type: "Stylist",
          location: "Makati",
          price: 500000,
          rating: 5.0,
          desc: "Event styling that transforms spaces into magical worlds. The top choice for grand, luxurious setups.",
          images: [
            "https://images.unsplash.com/photo-1527529482837-4698179dc6ce?w=600",
            "https://images.unsplash.com/photo-1522413452208-996ff3f3e740?w=600",
          ],
          contact: "gideon@events.com",
          map: "",
        },
        {
          id: 5,
          name: "Luna Bridal Couture",
          type: "Attire",
          location: "Taguig",
          price: 250000,
          rating: 4.8,
          desc: "Exquisite handcrafted wedding gowns designed for elegance and timeless beauty.",
          images: [
            "https://thumbs.dreamstime.com/b/store-window-display-wedding-dresses-290002443.jpg",
          ],
          contact: "contact@lunabridal.com",
          map: "",
        },
      ];

      let reviews = [
        {
          id: 101,
          vendorId: 1,
          user: "Sarah J.",
          rating: 5,
          text: "Absolutely stunning photos!",
          date: "2023-10-15",
          pros: "Cinematic quality",
          cons: "None",
        },
        {
          id: 102,
          vendorId: 1,
          user: "Mark D.",
          rating: 4,
          text: "Great team, slight delay in delivery.",
          date: "2023-11-02",
          pros: "Friendly staff",
          cons: "Timeline",
        },
        {
          id: 103,
          vendorId: 2,
          user: "Jenny L.",
          rating: 5,
          text: "The food was the highlight!",
          date: "2023-09-20",
          pros: "Roast Beef",
          cons: "None",
        },
      ];

      const app = {
        currentUser: null, // { name: 'User', role: 'user/admin' }

        init: () => {
          app.renderHome(mockVendors);
          // keep category UI in sync with the select
          app.updateCategoryUI();
          // reflect manual changes to the select
          document
            .getElementById("search-type")
            .addEventListener("change", () => {
              app.handleSearch();
              app.updateCategoryUI();
            });
        },

        // NAVIGATION
        navigate: (viewId) => {
          document.querySelectorAll(".container").forEach((el) => {
            if (
              el.id !== "view-home" &&
              el.id !== "view-detail" &&
              el.id !== "view-login" &&
              el.id !== "view-admin"
            )
              return;
            el.classList.add("hidden");
          });

          // Specific View Logic
          if (viewId === "home") {
            document.getElementById("view-home").classList.remove("hidden");
          } else if (viewId === "login") {
            document.getElementById("view-login").classList.remove("hidden");
          } else if (viewId === "admin") {
            if (app.currentUser && app.currentUser.role === "admin") {
              app.renderAdmin();
              document.getElementById("view-admin").classList.remove("hidden");
            } else {
              alert("Access Denied: Admins only.");
              app.navigate("login");
            }
          }
        },

        // AUTH SYSTEM
        login: () => {
          const email = document.getElementById("login-email").value;
          if (email.includes("admin")) {
            app.currentUser = {
              name: "Admin User",
              role: "admin",
              email: email,
            };
            document.getElementById("nav-admin").style.display = "block";
            app.navigate("admin");
          } else if (email) {
            app.currentUser = { name: "Jane Doe", role: "user", email: email };
            app.navigate("home");
          } else {
            alert("Please enter an email.");
            return;
          }

          // Update Header
          document.getElementById("auth-section").innerHTML = `
                <span style="font-weight:bold; margin-right:10px;">Hi, ${app.currentUser.name}</span>
                <button class="btn-auth" onclick="app.logout()">Logout</button>
            `;
        },

        logout: () => {
          app.currentUser = null;
          document.getElementById("nav-admin").style.display = "none";
          document.getElementById(
            "auth-section"
          ).innerHTML = `<button class="btn-auth" onclick="app.navigate('login')">Sign In / Register</button>`;
          app.navigate("home");
        },

        // HOME & SEARCH
        renderHome: (list) => {
          const container = document.getElementById("vendor-list-container");
          if (!list || list.length === 0) {
            container.innerHTML = `<div style="padding:40px; text-align:center; color:#666;">No vendors found for this category.</div>`;
            return;
          }

          container.innerHTML = list
            .map(
              (v) => `
                <div class="v-card" onclick="app.showVendorDetail(${v.id})">
                    <div class="v-img" style="background-image:url('${
                      v.images[0]
                    }'); position:relative;">
                        <span class="v-score">${v.rating}</span>
                    </div>
                    <div class="v-body">
                        <small style="color:#888; text-transform:uppercase; font-size:0.7rem;">${
                          v.type
                        } ‚Ä¢ ${v.location}</small>
                        <h3 class="serif" style="color:var(--brand-brown); margin: 5px 0;">${
                          v.name
                        }</h3>
                        <p style="font-size:0.9rem; color:#555; overflow:hidden; text-overflow:ellipsis; display:-webkit-box; -webkit-line-clamp:2; -webkit-box-orient:vertical;">${
                          v.desc
                        }</p>
                        <div style="margin-top:auto; padding-top:15px; font-weight:bold;">
                            Starts at ‚Ç±${v.price.toLocaleString()}
                        </div>
                    </div>
                </div>
            `
            )
            .join("");
        },

        handleSearch: () => {
          const txt = document
            .getElementById("search-text")
            .value.toLowerCase();
          const type = document.getElementById("search-type").value;
          const sort = document.getElementById("search-sort").value;

          let filtered = mockVendors.filter((v) => {
            return (
              v.name.toLowerCase().includes(txt) &&
              (type === "" || v.type === type)
            );
          });

          if (sort === "price_low") filtered.sort((a, b) => a.price - b.price);
          if (sort === "price_high") filtered.sort((a, b) => b.price - a.price);
          if (sort === "rating") filtered.sort((a, b) => b.rating - a.rating);

          app.renderHome(filtered);
          // Update category UI (highlight selected card)
          if (app.updateCategoryUI) app.updateCategoryUI();
        },

        filterByCat: (cat) => {
          const select = document.getElementById("search-type");
          const current = select.value;
          if (current === cat) {
            // toggle off -> show all
            select.value = "";
          } else {
            select.value = cat;
          }
          app.handleSearch();
        },

        updateCategoryUI: () => {
          const selected = document.getElementById("search-type").value;
          document.querySelectorAll(".cat-card").forEach((el) => {
            const cat = el.getAttribute("data-cat") || "";
            if (cat === selected && selected !== "") {
              el.classList.add("selected");
            } else {
              el.classList.remove("selected");
            }
          });
        },

        // VENDOR DETAILS & BOOKING
        showVendorDetail: (id) => {
          const v = mockVendors.find((x) => x.id === id);
          const vReviews = reviews.filter((r) => r.vendorId === id);

          document.getElementById("view-home").classList.add("hidden");
          document.getElementById("view-detail").classList.remove("hidden");

          const content = document.getElementById("detail-content");
          content.innerHTML = `
                <div class="detail-header">
                    <h1 class="serif">${v.name}</h1>
                    <p>üìç ${v.location} &nbsp;|&nbsp; ‚≠ê ${v.rating} (${
            vReviews.length
          } Reviews)</p>
                </div>

                <div class="detail-gallery">
                    <div class="gal-main" style="background-image:url('${
                      v.images[0]
                    }')"></div>
                    <div class="gal-sub">
                        <div class="gal-item" style="background-image:url('${
                          v.images[1] || v.images[0]
                        }')"></div>
                        <div class="gal-item" style="background-image:url('${
                          v.images[0]
                        }')"></div>
                    </div>
                </div>

                <div class="detail-layout">
                    <div>
                        <h3 class="serif">About this vendor</h3>
                        <p style="margin-bottom:20px;">${v.desc}</p>
                        
                        <h3 class="serif">Location</h3>
                        <div style="background:#eee; height:200px; display:flex; align-items:center; justify-content:center; margin-bottom:30px;">
                            ${
                              v.map
                                ? `<iframe src="${v.map}" width="100%" height="100%" style="border:0;" allowfullscreen="" loading="lazy"></iframe>`
                                : "Map Unavailable in Demo"
                            }
                        </div>

                        <div class="review-box">
                            <div style="display:flex; justify-content:space-between; align-items:center;">
                                <h3 class="serif">Reviews</h3>
                                <button class="btn-primary" onclick="app.toggleReviewForm()" style="font-size:0.8rem;">Write a Review</button>
                            </div>
                            
                            <div id="review-form-container" class="hidden" style="margin-top:20px; background:#f9f9f9; padding:15px;">
                                ${
                                  app.currentUser
                                    ? `
                                    <strong>Posting as ${app.currentUser.name}</strong>
                                    <select id="new-rating" class="form-select" style="margin:10px 0;"><option value="5">5 - Excellent</option><option value="4">4 - Very Good</option><option value="3">3 - Good</option></select>
                                    <textarea id="new-review-text" class="form-input" placeholder="Share your experience..."></textarea>
                                    <button class="btn-primary" style="margin-top:10px;" onclick="app.submitReview(${v.id})">Submit Review</button>
                                `
                                    : `<p><a onclick="app.navigate('login')" style="color:blue; cursor:pointer;">Log in</a> to write a review.</p>`
                                }
                            </div>

                            <div id="reviews-list" style="margin-top:20px;">
                                ${
                                  vReviews.length === 0
                                    ? "<p>No reviews yet.</p>"
                                    : vReviews
                                        .map(
                                          (r) => `
                                    <div class="r-item">
                                        <div class="r-header">
                                            <div><strong>${
                                              r.user
                                            }</strong> <span style="color:#888; font-size:0.8rem;">on ${
                                            r.date
                                          }</span></div>
                                            <div class="r-score-badge">${
                                              r.rating
                                            }</div>
                                        </div>
                                        <p>"${r.text}"</p>
                                        ${
                                          r.pros
                                            ? `<div class="pros">‚ûï ${r.pros}</div>`
                                            : ""
                                        }
                                        ${
                                          r.cons
                                            ? `<div class="cons">‚ûñ ${r.cons}</div>`
                                            : ""
                                        }
                                        ${
                                          app.currentUser &&
                                          app.currentUser.name === r.user
                                            ? `<button style="font-size:0.7rem; color:red; border:none; background:none; text-decoration:underline; margin-top:5px;" onclick="app.deleteReview(${r.id}, ${v.id})">Delete</button>`
                                            : ""
                                        }
                                    </div>
                                `
                                        )
                                        .join("")
                                }
                            </div>
                        </div>
                    </div>

                    <div>
                        <div class="booking-card">
                            <h3 class="serif" style="margin-bottom:15px;">Book ${
                              v.name
                            }</h3>
                            <div style="font-size:1.5rem; font-weight:bold; color:var(--brand-brown); margin-bottom:20px;">‚Ç±${v.price.toLocaleString()} <span style="font-size:0.9rem; color:#666; font-weight:normal;">starting price</span></div>
                            
                            <label style="font-size:0.8rem; font-weight:bold;">Wedding Date</label>
                            <input type="date" class="form-input" style="margin-bottom:15px;">
                            
                            <label style="font-size:0.8rem; font-weight:bold;">Message</label>
                            <textarea class="form-input" rows="3" placeholder="I'm interested in..." style="margin-bottom:15px;"></textarea>

                            <button class="btn-primary" style="width:100%" onclick="alert('Booking Inquiry Sent! The vendor will contact you at ' + (app.currentUser ? app.currentUser.email : 'your email address') + '.')">Check Availability</button>
                            <p style="font-size:0.8rem; color:#666; text-align:center; margin-top:10px;">You won't be charged yet</p>
                        </div>
                    </div>
                </div>
            `;
        },

        // REVIEW LOGIC
        toggleReviewForm: () => {
          document
            .getElementById("review-form-container")
            .classList.toggle("hidden");
        },

        submitReview: (vendorId) => {
          const text = document.getElementById("new-review-text").value;
          const rating = document.getElementById("new-rating").value;

          reviews.push({
            id: Date.now(),
            vendorId: vendorId,
            user: app.currentUser.name,
            rating: parseInt(rating),
            text: text,
            date: new Date().toISOString().split("T")[0],
            pros: "New Experience",
            cons: "None",
          });

          alert("Review Submitted!");
          app.showVendorDetail(vendorId); // Refresh
        },

        deleteReview: (reviewId, vendorId) => {
          if (confirm("Are you sure?")) {
            reviews = reviews.filter((r) => r.id !== reviewId);
            app.showVendorDetail(vendorId);
          }
        },

        // ADMIN LOGIC
        renderAdmin: () => {
          document.getElementById("admin-v-count").innerText =
            mockVendors.length;
          document.getElementById("admin-r-count").innerText = reviews.length;

          const tbody = document.getElementById("admin-v-list");
          tbody.innerHTML = mockVendors
            .map(
              (v) => `
                <tr>
                    <td>${v.id}</td>
                    <td>${v.name}</td>
                    <td>${v.type}</td>
                    <td>
                        <button class="action-btn btn-edit" onclick="alert('Edit Modal')">Edit</button>
                        <button class="action-btn btn-del" onclick="app.adminDeleteVendor(${v.id})">Delete</button>
                    </td>
                </tr>
            `
            )
            .join("");
        },

        adminDeleteVendor: (id) => {
          if (confirm("Delete this vendor listing?")) {
            const idx = mockVendors.findIndex((v) => v.id === id);
            if (idx > -1) mockVendors.splice(idx, 1);
            app.renderAdmin();
          }
        },
      };

      // Initialize App
      app.init();
    </script>
  </body>
</html>
